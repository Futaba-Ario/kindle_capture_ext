<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <style>
    body {
      width: 300px;
      padding: 10px;
      font-family: sans-serif;
    }

    button {
      width: 100%;
      padding: 8px;
      margin-bottom: 5px;
      cursor: pointer;
    }

    .status {
      font-size: 12px;
      color: #666;
      margin-top: 5px;
    }

    .metrics {
      font-size: 11px;
      white-space: pre-wrap;
      margin-top: 8px;
      color: #444;
      background: #f5f5f5;
      border: 1px solid #ddd;
      padding: 6px;
      border-radius: 4px;
    }

    details {
      margin-top: 6px;
      padding: 6px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background: #fafafa;
    }

    details label {
      display: block;
      margin-bottom: 4px;
      font-size: 12px;
    }

    .row {
      display: flex;
      gap: 6px;
      align-items: center;
    }

    .row input,
    .row select {
      flex: 1;
      min-width: 0;
    }
  </style>
</head>

<body>
  <h3>Kindle Capture</h3>
  <button id="btn-capture-one">1枚だけ撮る (PoC)</button>
  <button id="btn-turn-page">ページ送りテスト (PoC)</button>
  <hr>
  <label>ページ数: <input type="number" id="input-pages" value="10" style="width: 50px;"></label><br>
  <label>待機(ms): <input type="number" id="input-wait" value="1500" style="width: 50px;"></label><br>
  <label>分割(頁): <input type="number" id="input-split" value="0" style="width: 50px;" title="0で分割なし"></label>
  <details>
    <summary>詳細設定 (安定化)</summary>
    <label class="row">形式:
      <select id="input-format">
        <option value="jpeg" selected>jpeg</option>
        <option value="png">png</option>
      </select>
    </label>
    <label class="row">JPEG品質 (0-100): <input type="number" id="input-jpeg-quality" value="82"></label>
    <label class="row">長辺上限(px): <input type="number" id="input-max-long-edge" value="2200"></label>
    <label class="row">チェックポイント頁: <input type="number" id="input-checkpoint-pages" value="20"></label>
    <label class="row">適応待機:
      <select id="input-adaptive-delay">
        <option value="true" selected>ON</option>
        <option value="false">OFF</option>
      </select>
    </label>
    <label class="row">最小待機(ms): <input type="number" id="input-min-wait" value="900"></label>
    <label class="row">最大待機(ms): <input type="number" id="input-max-wait" value="3500"></label>
  </details>
  <div style="display: flex; gap: 5px; margin-top: 5px;">
    <button id="btn-start-loop" style="background-color: #e7f3fe;">開始 (PDF)</button>
    <button id="btn-stop" style="background-color: #fee;">停止</button>
  </div>
  <div id="status" class="status"
    style="white-space: pre-wrap; margin-top: 10px; border-top: 1px solid #ccc; padding-top: 5px;">Ready</div>
  <div id="metrics" class="metrics">Stage: idle</div>
  <script src="popup.js"></script>
</body>

</html>
